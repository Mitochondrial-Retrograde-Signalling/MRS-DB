(this["webpackJsonparabidopsis-reactjs"]=this["webpackJsonparabidopsis-reactjs"]||[]).push([[0],{36:function(e,t,a){e.exports=a(80)},43:function(e,t,a){},80:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(30),o=a.n(r),i=(a(43),a(15)),s=a(31),c=a.n(s),p=a(35),m=(a(54),a(3)),h=a(34),d=a(14),u=a(32);function g(){const[e,t]=Object(n.useState)({}),[a,r]=Object(n.useState)([]),[o,s]=Object(n.useState)(null),[h,g]=Object(n.useState)([]),[f,y]=Object(n.useState)([]),[v,b]=Object(n.useState)([]),[x,E]=Object(n.useState)([0,0]),[w,S]=Object(n.useState)({}),[j,O]=Object(n.useState)([]),[k,C]=Object(n.useState)([]),[z,L]=Object(n.useState)([]),[I,G]=Object(n.useState)([]),[N,R]=Object(n.useState)({}),[B,W]=Object(n.useState)(!1),[D,M]=Object(n.useState)({}),T=Object(m.l)(),F=Object(m.n)(),H=Object(n.useRef)(!1),[P,A]=Object(n.useState)(!1),_={"Companion cell":"Companion<br>cell",Epidermis:"Epi-<br>dermis","G2/M phase":"G2/m<br>phase","Leaf guard cell":"Leaf<br>guard<br>cell","Leaf pavement cell":"Leaf<br>pave-<br>mentcell",Mesophyll:"Meso<br>phyll","Phloem parenchyma":"Phloem<br>paren-<br>chyma","S phase":"S phase",Unknown:"Unknown",Xylem:"Xylem"};Object(n.useEffect)(()=>{const e=()=>W(window.scrollY>300);return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),Object(n.useEffect)(()=>{const e=["1h.json","3h.json","6h.json"];Promise.all(e.map(e=>fetch("/data/processed/"+e).then(e=>e.json()))).then(a=>{const n={},l=new Set,o={},i=new Set,s=new Set,c={},p={};e.forEach((e,t)=>{const r=a[t],m=r.Timepoint+"h";c[m]=!0,n[m]=r.GeneList,Object.entries(r.GeneList).forEach(e=>{let[t,a]=e;l.add(t),o[t]||(o[t]=new Set),p[t]||(p[t]={}),Object.entries(a).forEach(e=>{var a,n;let[l,r]=e;o[t].add(l);const c=(null===r||void 0===r||null===(a=r.Details)||void 0===a?void 0:a.GeneName)||"",m=c?`${l} (${c})`:l,h=(null===r||void 0===r||null===(n=r.Details)||void 0===n?void 0:n.Description)||"";p[t][l]={id:l,name:c,label:m,description:h},Object.entries(r).forEach(e=>{let[t,a]=e;"Details"!==t&&(s.add(t),Object.keys(a||{}).forEach(e=>{i.add(e)}))})})})});const m=Object.keys(c).map(e=>parseInt(e)).sort((e,t)=>e-t);t(n),b(m),E([m[0],m[m.length-1]]),r(Array.from(l).sort()),S(o),M(p),O(Array.from(i).sort()),L(Array.from(s).sort())})},[]),Object(n.useEffect)(()=>{if(o&&w[o]){const e=D[o]||{},t=Object.values(e).map(e=>{let{id:t,label:a}=e;return{value:t,label:a||t}});g(t),y([])}},[o,w,D]),Object(n.useEffect)(()=>{setTimeout(()=>{window.dispatchEvent(new Event("resize"))},150)},[f,o,I,k]),Object(n.useEffect)(()=>{var e,t,n;if(0===a.length||0===z.length||0===j.length||0===v.length||0===Object.keys(w).length)return;if(H.current)return void(H.current=!1);const l=new URLSearchParams(T.search),r=l.get("geneList")||a[0],o=(null===(e=l.get("cellTypes"))||void 0===e?void 0:e.split(","))||[j[0]],i=(null===(t=l.get("genotypes"))||void 0===t?void 0:t.split(","))||[z[0]],c=null===(n=l.get("tpRange"))||void 0===n?void 0:n.split(",").map(Number),p=2!==(null===c||void 0===c?void 0:c.length)||c.includes(NaN)?[v[0],v[v.length-1]]:c;s(r),C(o),G(i),E(p)},[T.search,a,z,j,w,v]),Object(n.useEffect)(()=>{var e;const t=((null===(e=new URLSearchParams(T.search).get("genes"))||void 0===e?void 0:e.split(","))||[]).filter(e=>h.includes(e));t.length&&y(t)},[h,T.search]),Object(n.useEffect)(()=>{if(!o||0===f.length||0===I.length||0===k.length||0===x[0]&&0===x[1])return;const e=new URLSearchParams;o&&e.set("geneList",o),f.length&&e.set("genes",f.join(",")),I.length&&e.set("genotypes",I.join(",")),k.length&&e.set("cellTypes",k.join(",")),2===x.length&&e.set("tpRange",x.join(","));const t=e.toString();t!==(T.search.startsWith("?")?T.search.substring(1):T.search)&&(H.current=!0,F({search:t},{replace:!0}))},[o,f,I,k,x,F,T.search]);return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{style:{position:"sticky",top:0,backgroundColor:"#f8f9fa",zIndex:100,padding:"1rem 3rem 1.5rem 3rem",borderBottom:"1px solid #ccc",width:"100%"}},l.a.createElement("div",{style:{width:"100%",marginBottom:"1rem"}},l.a.createElement("h2",{style:{margin:0}},"Arabidopsis Gene Expression Explorer")),l.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"2rem",alignItems:"flex-start"}},l.a.createElement("div",{style:{maxWidth:"150px",flex:"1 1 240px"}},l.a.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",marginBottom:"0.5rem"}},l.a.createElement("strong",null,"Gene List"),l.a.createElement("span",{title:"Select a Gene List to explore gene expression.",style:{marginLeft:"8px",cursor:"help",fontSize:"1rem",color:"#666"}},"\u2139\ufe0f")),l.a.createElement("div",{style:{height:56}},l.a.createElement(i.a,{options:a.map(e=>({value:e,label:e})),value:o?{value:o,label:o}:null,onChange:e=>s((null===e||void 0===e?void 0:e.value)||null),placeholder:"Search Gene List...",isSearchable:!0,styles:{container:e=>({...e,width:"100%"})}}))),l.a.createElement("div",{style:{maxWidth:"220px",flex:"1 1 240px"}},l.a.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",marginBottom:"0.5rem"}},l.a.createElement("strong",null,"Genotypes"),l.a.createElement("span",{title:"Compare gene expression across selected genotypes.",style:{marginLeft:"8px",cursor:"help",fontSize:"1rem",color:"#666"}},"\u2139\ufe0f")),l.a.createElement(i.a,{isMulti:!0,options:z.map(e=>({value:e,label:e})),value:I.map(e=>({value:e,label:e})),onChange:e=>G((e||[]).map(e=>e.value)),placeholder:"Select genotypes",closeMenuOnSelect:!1,isSearchable:!0,styles:{container:e=>({...e,width:"100%"}),valueContainer:e=>({...e,maxHeight:80,overflowY:"auto",flexWrap:"wrap"}),menu:e=>({...e,zIndex:9999})}})),l.a.createElement("div",{style:{maxWidth:"230px",flex:"1 1 240px"}},l.a.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",marginBottom:"0.5rem"}},l.a.createElement("strong",null,"Genes"),l.a.createElement("span",{title:"Choose one or more genes from the selected geneList.",style:{marginLeft:"8px",cursor:"help",fontSize:"1rem",color:"#666"}},"\u2139\ufe0f")),l.a.createElement("div",{style:{height:120,display:"flex",alignItems:"stretch"}},console.log("Gene options:",h),l.a.createElement(i.a,{isMulti:!0,options:(h||[]).map(e=>"string"===typeof e?{value:e,label:e}:e),value:f.map(e=>h.find(t=>t.value===e)||{value:e,label:e}),onChange:e=>y((e||[]).map(e=>e.value)),filterOption:(e,t)=>Object(u.a)([e],t,{keys:["label"]}).length>0,placeholder:"Select genes",isSearchable:!0,isDisabled:!o,styles:{container:e=>({...e,width:"100%"}),control:e=>({...e,minHeight:120,height:120,alignItems:"flex-start"}),valueContainer:e=>({...e,maxHeight:80,overflowY:"auto",flexWrap:"wrap"}),menu:e=>({...e,zIndex:9999})}}))),f.length>0&&l.a.createElement("div",{onClick:()=>A(e=>!e),style:{position:"fixed",top:"40%",right:P?"350px":0,zIndex:1e3,width:"40px",height:"160px",backgroundColor:"#3276db",color:"white",writingMode:"vertical-rl",transform:"rotate(180deg)",fontSize:"0.85rem",fontWeight:"bold",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",borderTopRightRadius:"6px",borderBottomRightRadius:"6px",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",transition:"right 0.3s ease-in-out",userSelect:"none"}},P?"Hide Gene Description":"Show Gene Description"),f.length>0&&l.a.createElement("div",{style:{position:"fixed",top:0,right:P?0:"-320px",height:"100vh",width:P?"320px":"40px",backgroundColor:"#f7f5ed",borderLeft:"1px solid #ccc",boxShadow:"-2px 0 6px rgba(0,0,0,0.1)",padding:"1rem",overflowY:"auto",zIndex:1001,transition:"right 0.3s ease-in-out"}},l.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},l.a.createElement("h4",{style:{margin:0}},"Gene Descriptions"),l.a.createElement("button",{onClick:()=>A(!1),style:{border:"none",background:"transparent",fontSize:"1.2rem",cursor:"pointer"}},"\u2715")),l.a.createElement("hr",null),f.map(e=>{var t;const a=null===(t=D[o])||void 0===t?void 0:t[e];return l.a.createElement("div",{key:e,style:{marginBottom:"1rem"}},l.a.createElement("strong",null,null===a||void 0===a?void 0:a.label),l.a.createElement("div",{style:{fontSize:"0.9rem",color:"#555"}},(null===a||void 0===a?void 0:a.description)||"No description available."))})),l.a.createElement("div",{style:{maxWidth:"240px",flex:"1 1 240px"}},l.a.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",marginBottom:"0.5rem"}},l.a.createElement("strong",null,"Cell Types"),l.a.createElement("span",{title:"Filter by specific cell types to focus your analysis.",style:{marginLeft:"8px",cursor:"help",fontSize:"1rem",color:"#666"}},"\u2139\ufe0f")),l.a.createElement("div",{style:{height:120,display:"flex",alignItems:"stretch"}},l.a.createElement(i.a,{isMulti:!0,options:j.map(e=>({value:e,label:e})),value:k.map(e=>({value:e,label:e})),onChange:e=>C((e||[]).map(e=>e.value)),placeholder:"Select cell types",closeMenuOnSelect:!1,isSearchable:!0,styles:{container:e=>({...e,width:"100%"}),control:e=>({...e,minHeight:120,height:120,alignItems:"flex-start"}),valueContainer:e=>({...e,maxHeight:80,overflowY:"auto",flexWrap:"wrap"}),menu:e=>({...e,zIndex:9999})}}))),v.length>1&&l.a.createElement("div",{style:{maxWidth:"280px",flex:"1 1 240px"}},l.a.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",marginBottom:"0.5rem"}},l.a.createElement("strong",null,"Timepoint"),l.a.createElement("span",{title:"Select a range of timepoints to display plots.",style:{marginLeft:"8px",cursor:"help",fontSize:"1rem",color:"#666"}},"\u2139\ufe0f")),l.a.createElement(p.a,{range:!0,min:v[0],max:v[v.length-1],value:x,onChange:e=>E(e),marks:v.reduce((e,t)=>(e[t]=t.toString(),e),{}),step:null,allowCross:!1,style:{width:"100%"}})))),l.a.createElement("div",{style:{padding:"1rem",paddingLeft:"5vw"}},v.filter(e=>e>=x[0]&&e<=x[1]).map(t=>(t=>{var a;const n=t+"h",r=null===(a=e[n])||void 0===a?void 0:a[o];if(!r)return null;const i=new Set;f.forEach(e=>{const t=r[e];t&&I.forEach(e=>{const a=t[e]||{};k.forEach(e=>{const t=a[e]||{};Object.keys(t).forEach(t=>{t.startsWith("log2FC")&&i.add(`${e}||${t}`)})})})});const s=Array.from(i).sort(),p=s.map(e=>e.split("||")[1].replace("log2FC_","")),m=50*p.length+400,h=50*f.length*I.length+200,u=[],g=[],y=[],v=[];f.forEach(e=>{I.forEach(t=>{u.push(`${e} - ${t}`);const a=[],n=[],l=[];s.forEach(o=>{var i,s,c;const[p,m]=o.split("||"),h=null===(i=r[e])||void 0===i||null===(s=i[t])||void 0===s||null===(c=s[p])||void 0===c?void 0:c[m];"ns"===h?(a.push(NaN),n.push(1),l.push("ns")):void 0===h||null===h?(a.push(null),n.push(1),l.push("No data")):(a.push(parseFloat(h)),n.push(0),l.push(h))}),g.push(a),y.push(n),v.push(l)})});const b=[],x=[];for(let e=0;e<f.length;e++){const t=e*I.length,a=t+I.length-1;b.push({type:"rect",xref:"x",yref:"y",x0:-.5,x1:p.length-.5,y0:t-.5,y1:a+.5,line:{color:"white",width:2},layer:"above",fillcolor:"rgba(0,0,0,0)"})}const E={};s.forEach((e,t)=>{const[a]=e.split("||");E[a]||(E[a]=[]),E[a].push(t)}),Object.entries(E).forEach(e=>{let[t,a]=e;const n=Math.min(...a),l=Math.max(...a),r=1===a.length&&_[t]?_[t]:t;b.push({type:"rect",xref:"x",yref:"y",x0:n-.5,x1:l+.5,y0:u.length-.5+.2,y1:u.length-.5+1.2,fillcolor:"#bfbaba",line:{color:"white",width:2},layer:"below"}),x.push({x:(n+l)/2,y:u.length-.5+.7,xref:"x",yref:"y",text:r,showarrow:!1,font:{size:9,color:"#333"},align:"center"}),n>0&&b.push({type:"line",x0:n-.5,x1:n-.5,y0:-.5,y1:u.length-.5,xref:"x",yref:"y",line:{color:"white",width:2},layer:"above"})});const w=0===g.length||g.flat().every(e=>null===e||Number.isNaN(e));if(!p.length||!u.length||!g.length||w)return l.a.createElement("div",{id:"plot-"+n,key:n,style:{marginBottom:"3rem"}},l.a.createElement("h3",null,n),l.a.createElement("div",{style:{marginBottom:"0.5rem",color:"#666",fontStyle:"italic"}},"All values are not statistically significant or missing. No heatmap rendered."));const S=!1!==N[n];return l.a.createElement("div",{id:"plot-"+n,key:n,style:{marginBottom:"3rem"}},l.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"2rem",flexWrap:"wrap"}},l.a.createElement("div",{style:{display:"flex",alignItems:"center",gap:"1rem"}},l.a.createElement("h3",{style:{margin:0}},n,l.a.createElement("span",{title:"This heatmap shows log\u2082 fold change. Gray tiles represent 'ns' (not statistically significant) or No data.",style:{marginLeft:"8px",cursor:"help",fontSize:"1rem",color:"#666"}},"\u2139\ufe0f")),l.a.createElement("button",{onClick:()=>{R(e=>({...e,[n]:!S}))},style:{fontSize:"0.85rem"}},S?"Hide":"Show")),l.a.createElement("button",{onClick:()=>{var a;const n=t+"h",l=null===(a=e[n])||void 0===a?void 0:a[o];if(!l)return;const r={},i=[];[...k].sort().forEach(e=>{const t=new Set;f.forEach(a=>{I.forEach(n=>{var r,o;const i=null===l||void 0===l||null===(r=l[a])||void 0===r||null===(o=r[n])||void 0===o?void 0:o[e];i&&Object.keys(i).forEach(e=>t.add(e))})});const a=Array.from(t).sort();r[e]=a,a.forEach(t=>i.push([e,t]))});const s=["Gene","Genotype",...i.map(e=>{let[t]=e;return t})],c=["","",...i.map(e=>{let[t,a]=e;return a})],p=[];let m=2;for(const[e,t]of Object.entries(r)){const e=t.length;e>1&&p.push({s:{r:0,c:m},e:{r:0,c:m+e-1}}),m+=e}const h=[];f.forEach(e=>{I.forEach(t=>{const a=[e,t];i.forEach(n=>{var r,o,i;let[s,c]=n;const p=null===l||void 0===l||null===(r=l[e])||void 0===r||null===(o=r[t])||void 0===o||null===(i=o[s])||void 0===i?void 0:i[c];a.push(void 0===p||null===p||Number.isNaN(p)?"No Data":p)}),h.push(a)})});const u=[s,c,...h],g=d.a.aoa_to_sheet(u);g["!merges"]=p;const y=d.a.book_new();d.a.book_append_sheet(y,g,"Sheet1"),d.b(y,n+"_data.xlsx")},style:{marginLeft:"auto",marginRight:"2rem",padding:"0.4rem 0.8rem",backgroundColor:"#3276db",color:"white",border:"none",borderRadius:"4px",fontSize:"0.9rem",cursor:"pointer"}},"Download ",n," Data")),S&&l.a.createElement(c.a,{useResizeHandler:!1,style:{width:m+"px",height:h+"px"},data:[{z:g,x:p.map((e,t)=>t),y:u.map((e,t)=>t),type:"heatmap",colorscale:[[0,"blue"],[.5,"white"],[1,"red"]],zmid:0,showscale:!0,colorbar:{title:{text:"log\u2082 Fold Change",side:"right",font:{size:12,weight:"bold"}}},hovertext:v,hovertemplate:"%{y}<br>%{x}: %{hovertext}<extra></extra>"},{z:y,x:p.map((e,t)=>t),y:u.map((e,t)=>t),type:"heatmap",colorscale:[[0,"rgba(0,0,0,0)"],[1,"#d3d3d3"]],showscale:!1,hoverinfo:"skip",opacity:1}],layout:{width:m,height:h,margin:{l:180,r:30,t:40,b:140},yaxis:{tickvals:u.map((e,t)=>t),ticktext:u,automargin:!0,dtick:1,constrain:"domain",ticks:""},xaxis:{tickvals:p.map((e,t)=>t),ticktext:p,tickangle:-60,tickfont:{size:12},automargin:!0,constrain:"domain",ticks:"",showline:!1,showgrid:!1,zeroline:!1},shapes:b,annotations:x},config:{responsive:!0}}))})(t)),B&&l.a.createElement("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),style:{position:"fixed",bottom:"30px",right:"30px",zIndex:1e3,padding:"0.6rem 0.95rem",fontSize:"1.5rem",borderRadius:"50%",backgroundColor:"#007bff",color:"white",border:"none",boxShadow:"0 2px 6px rgba(0,0,0,0.2)",cursor:"pointer"}},"\u2b9d")))}function f(){return l.a.createElement(h.a,null,l.a.createElement(g,null))}var y=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,81)).then(t=>{let{getCLS:a,getFID:n,getFCP:l,getLCP:r,getTTFB:o}=t;a(e),n(e),l(e),r(e),o(e)})};o.a.createRoot(document.getElementById("root")).render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(f,null))),y()}},[[36,1,2]]]);
//# sourceMappingURL=main.0e006656.chunk.js.map