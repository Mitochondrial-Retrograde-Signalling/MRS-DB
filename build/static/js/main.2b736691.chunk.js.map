{"version":3,"sources":["App.js","reportWebVitals.js","index.js"],"names":["App","data","setData","useState","geneListOptions","setGeneListOptions","selectedGeneList","setSelectedGeneList","geneOptions","setGeneOptions","selectedGenes","setSelectedGenes","timepoints","setTimepoints","selectedTimepointRange","setSelectedTimepointRange","allGenesByGeneList","setAllGenesByGeneList","cellTypes","setCellTypes","selectedCellTypes","setSelectedCellTypes","genotypes","setGenotypes","selectedGenotypes","setSelectedGenotypes","plotVisibility","setPlotVisibility","showScrollUp","setShowScrollUp","location","useLocation","navigate","useNavigate","skipNextSync","useRef","wrappedLabels","useEffect","handleScroll","window","scrollY","addEventListener","removeEventListener","files","Promise","all","map","f","fetch","then","res","json","jsons","newData","geneLists","Set","allCellTypes","allGenotypes","tpMap","forEach","file","i","tp","Timepoint","GeneList","Object","entries","_ref","geneList","genes","add","_ref2","gene","geneData","_ref3","genotype","cellMap","keys","cellType","numericTPs","parseInt","sort","a","b","length","Array","from","setTimeout","dispatchEvent","Event","_params$get","_params$get2","_params$get3","current","params","URLSearchParams","search","org","get","cellTypesParsed","split","genotypesParsed","tpRange","Number","validRange","includes","NaN","_params$get4","validGenes","filter","g","set","join","newSearch","toString","startsWith","substring","replace","React","createElement","Fragment","style","position","top","backgroundColor","zIndex","padding","borderBottom","width","marginBottom","margin","display","flexWrap","gap","alignItems","maxWidth","flex","title","marginLeft","cursor","fontSize","color","height","Select","options","o","value","label","onChange","opt","placeholder","isSearchable","styles","container","base","isMulti","opts","closeMenuOnSelect","valueContainer","maxHeight","overflowY","menu","isDisabled","control","minHeight","ct","Slider","range","min","max","marks","reduce","acc","step","allowCross","paddingLeft","_data$tpKey","tpKey","geneListData","xMetaSet","clusters","cluster","xMeta","xLabels","k","plotWidth","plotHeight","yLabels","zData","maskData","hoverData","push","zRow","maskRow","hoverTextRow","key","_geneListData$gene","_geneListData$gene$ge","_geneListData$gene$ge2","val","undefined","parseFloat","shapes","annotations","startIndex","endIndex","type","xref","yref","x0","x1","y0","y1","line","layer","fillcolor","cellTypeGroups","idx","_ref4","indices","start","Math","end","displayLabel","x","y","text","showarrow","font","size","align","allNull","flat","every","v","isNaN","id","fontStyle","visible","justifyContent","marginTop","onClick","toggleVisibility","prev","downloadTPData","_data$tpKey2","clusterMap","allPairs","_geneListData$gene2","_geneListData$gene2$g","clusterObj","c","clusterList","headerRow1","_ref5","headerRow2","_ref6","_","cl","merges","col","span","s","r","e","dataRows","row","_ref7","_geneListData$gene3","_geneListData$gene3$g","_geneListData$gene3$g2","sheetData","ws","XLSX","aoa_to_sheet","wb","book_new","book_append_sheet","marginRight","border","borderRadius","Plot","useResizeHandler","z","colorscale","zmid","showscale","colorbar","side","weight","hovertext","hovertemplate","hoverinfo","opacity","layout","l","t","yaxis","tickvals","ticktext","automargin","dtick","constrain","ticks","xaxis","tickangle","tickfont","showline","showgrid","zeroline","config","responsive","renderPlot","scrollTo","behavior","bottom","right","boxShadow","WrappedApp","BrowserRouter","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","createRoot","document","getElementById","render","StrictMode"],"mappings":"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","file":"static/js/main.2b736691.chunk.js","sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport Select from \"react-select\";\nimport Plot from \"react-plotly.js\";\nimport Slider from 'rc-slider';\nimport 'rc-slider/assets/index.css';\nimport { useLocation, useNavigate, BrowserRouter } from 'react-router-dom';\nimport * as XLSX from \"xlsx\";\n\nfunction App() {\n  const [data, setData] = useState({});\n  const [geneListOptions, setGeneListOptions] = useState([]);\n  const [selectedGeneList, setSelectedGeneList] = useState(null);\n  const [geneOptions, setGeneOptions] = useState([]);\n  const [selectedGenes, setSelectedGenes] = useState([]);\n  const [timepoints, setTimepoints] = useState([]);\n  const [selectedTimepointRange, setSelectedTimepointRange] = useState([0, 0]);\n  const [allGenesByGeneList, setAllGenesByGeneList] = useState({});\n  const [cellTypes, setCellTypes] = useState([]);\n  const [selectedCellTypes, setSelectedCellTypes] = useState([]);\n  const [genotypes, setGenotypes] = useState([]);\n  const [selectedGenotypes, setSelectedGenotypes] = useState([]);\n  const [plotVisibility, setPlotVisibility] = useState({});\n  const [showScrollUp, setShowScrollUp] = useState(false);\n\n  const location = useLocation();\n  const navigate = useNavigate();\n  const skipNextSync = useRef(false);\n\n  // This is used to avoid label overflow\n  const wrappedLabels = {\n    \"Companion cell\": \"Companion<br>cell\",\n    \"Epidermis\": \"Epi-<br>dermis\",\n    \"G2/M phase\": \"G2/m<br>phase\",\n    \"Leaf guard cell\": \"Leaf<br>guard<br>cell\",\n    \"Leaf pavement cell\": \"Leaf<br>pave-<br>ment\\cell\",\n    \"Mesophyll\": \"Meso<br>phyll\",\n    \"Phloem parenchyma\": \"Phloem<br>paren-<br>chyma\",\n    \"S phase\": \"S phase\",\n    \"Unknown\": \"Unknown\",\n    \"Xylem\": \"Xylem\",\n  };\n  \n  // This is for the scroll up button\n  useEffect(() => {\n    const handleScroll = () => setShowScrollUp(window.scrollY > 300);\n    window.addEventListener(\"scroll\", handleScroll);\n    return () => window.removeEventListener(\"scroll\", handleScroll);\n  }, []);\n  \n  // This is for reading the json files\n  useEffect(() => {\n    const files = [\"1h.json\", \"3h.json\", \"6h.json\"];\n    Promise.all(\n      files.map(f => fetch(`/data/processed/${f}`).then(res => res.json()))\n    ).then(jsons => {\n      const newData = {};\n      const geneLists = new Set();\n      const allGenesByGeneList = {};\n      const allCellTypes = new Set();\n      const allGenotypes = new Set();\n      const tpMap = {};\n\n      files.forEach((file, i) => {\n        const json = jsons[i];\n        const tp = `${json.Timepoint}h`;\n        tpMap[tp] = true;\n        newData[tp] = json.GeneList;\n\n        Object.entries(json.GeneList).forEach(([geneList, genes]) => {\n          geneLists.add(geneList);\n          if (!allGenesByGeneList[geneList]) allGenesByGeneList[geneList] = new Set();\n\n          Object.entries(genes).forEach(([gene, geneData]) => {\n            allGenesByGeneList[geneList].add(gene);\n            Object.entries(geneData).forEach(([genotype, cellMap]) => {\n              if (genotype === \"Details\") return;\n              allGenotypes.add(genotype);\n              Object.keys(cellMap || {}).forEach(cellType => {\n                allCellTypes.add(cellType);\n              });\n            });\n          });\n        });\n      });\n\n      const numericTPs = Object.keys(tpMap)\n        .map(tp => parseInt(tp))\n        .sort((a, b) => a - b);\n\n      setData(newData);\n      setTimepoints(numericTPs);\n      setSelectedTimepointRange([numericTPs[0], numericTPs[numericTPs.length - 1]]);\n      setGeneListOptions(Array.from(geneLists).sort());\n      setAllGenesByGeneList(allGenesByGeneList);\n      setCellTypes(Array.from(allCellTypes).sort());\n      setGenotypes(Array.from(allGenotypes).sort());\n    });\n  }, []);\n\n  // This is for showing the genes specific to the selected GeneList\n  useEffect(() => {\n    if (selectedGeneList && allGenesByGeneList[selectedGeneList]) {\n      const genes = Array.from(allGenesByGeneList[selectedGeneList]).sort();\n      setGeneOptions(genes);\n      setSelectedGenes([]);\n    }\n  }, [selectedGeneList, allGenesByGeneList]);\n\n  // This resizes the heatmap upon new selection\n  // It has some time delay to avoid early rendering\n  useEffect(() => {\n    setTimeout(() => {\n      window.dispatchEvent(new Event('resize'));\n    }, 150);\n  }, [selectedGenes, selectedGeneList, selectedGenotypes, selectedCellTypes]);\n\n  // Sync geneList and others first — but NOT genes\n  useEffect(() => {\n    if (\n      geneListOptions.length === 0 ||\n      genotypes.length === 0 ||\n      cellTypes.length === 0 ||\n      timepoints.length === 0 ||\n      Object.keys(allGenesByGeneList).length === 0\n    ) return;\n\n    if (skipNextSync.current) {\n      skipNextSync.current = false;\n      return;\n    }\n\n    const params = new URLSearchParams(location.search);\n    const org = params.get(\"geneList\") || geneListOptions[0];\n    const cellTypesParsed = params.get(\"cellTypes\")?.split(\",\") || [cellTypes[0]];\n    const genotypesParsed = params.get(\"genotypes\")?.split(\",\") || [genotypes[0]];\n\n    const tpRange = params.get(\"tpRange\")?.split(\",\").map(Number);\n    const validRange = tpRange?.length === 2 && !tpRange.includes(NaN)\n      ? tpRange\n      : [timepoints[0], timepoints[timepoints.length - 1]];\n\n    setSelectedGeneList(org);\n    setSelectedCellTypes(cellTypesParsed);\n    setSelectedGenotypes(genotypesParsed);\n    setSelectedTimepointRange(validRange);\n  }, [\n    location.search,\n    geneListOptions,\n    genotypes,\n    cellTypes,\n    allGenesByGeneList,\n    timepoints\n  ]);\n\n  // Sync genes separately — only after geneOptions are available\n  useEffect(() => {\n    const params = new URLSearchParams(location.search);\n    const genes = params.get(\"genes\")?.split(\",\") || [];\n    const validGenes = genes.filter(g => geneOptions.includes(g));\n    if (validGenes.length) {\n      setSelectedGenes(validGenes);\n    }\n  }, [geneOptions, location.search]);\n\n  // Sync state → URL only if meaningful values are selected\n  useEffect(() => {\n    if (\n      !selectedGeneList ||\n      selectedGenes.length === 0 ||\n      selectedGenotypes.length === 0 ||\n      selectedCellTypes.length === 0 ||\n      (selectedTimepointRange[0] === 0 && selectedTimepointRange[1] === 0)\n    ) {\n      return;\n    }\n\n    const params = new URLSearchParams();\n    if (selectedGeneList) params.set(\"geneList\", selectedGeneList);\n    if (selectedGenes.length) params.set(\"genes\", selectedGenes.join(\",\"));\n    if (selectedGenotypes.length) params.set(\"genotypes\", selectedGenotypes.join(\",\"));\n    if (selectedCellTypes.length) params.set(\"cellTypes\", selectedCellTypes.join(\",\"));\n    if (selectedTimepointRange.length === 2) params.set(\"tpRange\", selectedTimepointRange.join(\",\"));\n\n    const newSearch = params.toString();\n    const currentSearch = location.search.startsWith(\"?\") ? location.search.substring(1) : location.search;\n\n    if (newSearch !== currentSearch) {\n      skipNextSync.current = true;\n      navigate({ search: newSearch }, { replace: true });\n    }\n  }, [\n    selectedGeneList,\n    selectedGenes,\n    selectedGenotypes,\n    selectedCellTypes,\n    selectedTimepointRange,\n    navigate,\n    location.search\n  ]);\n\n  // Renders plot for selected timepoint/s\n  const renderPlot = (tp) => {\n    const tpKey = `${tp}h`;\n    const geneListData = data[tpKey]?.[selectedGeneList];\n    if (!geneListData) return null;\n\n    const xMetaSet = new Set();\n    selectedGenes.forEach(gene => {\n      const geneData = geneListData[gene];\n      if (!geneData) return;\n      selectedGenotypes.forEach(genotype => {\n        const cellMap = geneData[genotype] || {};\n        selectedCellTypes.forEach(cellType => {\n          const clusters = cellMap[cellType] || {};\n          Object.keys(clusters).forEach(cluster => {\n            if (cluster.startsWith(\"log2FC\")) {\n              xMetaSet.add(`${cellType}||${cluster}`);\n            }\n          });\n        });\n      });\n    });\n\n    const xMeta = Array.from(xMetaSet).sort();\n    const xLabels = xMeta.map(k => k.split(\"||\")[1].replace(\"log2FC_\", \"\"));\n\n    const tileSize = 50;\n    const plotWidth = tileSize * xLabels.length + 400;\n    const plotHeight = tileSize * selectedGenes.length * selectedGenotypes.length + 200;\n\n    const yLabels = [];\n    const zData = [];\n    const maskData = [];\n    const hoverData = [];\n\n    selectedGenes.forEach(gene => {\n      selectedGenotypes.forEach(genotype => {\n        yLabels.push(`${gene} - ${genotype}`);\n        const zRow = [];\n        const maskRow = [];\n        const hoverTextRow = [];\n\n        xMeta.forEach(key => {\n          const [cellType, cluster] = key.split(\"||\");\n          const val = geneListData[gene]?.[genotype]?.[cellType]?.[cluster];\n        \n          if (val === \"ns\") {\n            zRow.push(NaN);              // Still not plottable\n            maskRow.push(1);             // Masked\n            hoverTextRow.push(\"ns\");     // show \"ns\"\n          } else if (val === undefined || val === null) {\n            zRow.push(null);             // Missing data\n            maskRow.push(1);\n            hoverTextRow.push(\"No data\");  // distinguish\n          } else {\n            zRow.push(parseFloat(val));\n            maskRow.push(0);\n            hoverTextRow.push(val);\n          }\n        });\n\n        zData.push(zRow);\n        maskData.push(maskRow);\n        hoverData.push(hoverTextRow);\n      });\n    });\n\n    const shapes = [];\n    const annotations = [];\n\n    for (let i = 0; i < selectedGenes.length; i++) {\n      const startIndex = i * selectedGenotypes.length;\n      const endIndex = startIndex + selectedGenotypes.length - 1;\n\n      shapes.push({\n        type: 'rect',\n        xref: 'x',\n        yref: 'y',\n        x0: -0.5,\n        x1: xLabels.length - 0.5,\n        y0: startIndex - 0.5,\n        y1: endIndex + 0.5,\n        line: {\n          color: 'white',\n          width: 2\n        },\n        layer: 'above',\n        fillcolor: 'rgba(0,0,0,0)'\n      });\n    }\n\n    const cellTypeGroups = {};\n    xMeta.forEach((key, idx) => {\n      const [cellType] = key.split(\"||\");\n      if (!cellTypeGroups[cellType]) cellTypeGroups[cellType] = [];\n      cellTypeGroups[cellType].push(idx);\n    });\n\n    Object.entries(cellTypeGroups).forEach(([cellType, indices]) => {\n      const start = Math.min(...indices);\n      const end = Math.max(...indices);\n    \n      // Use the wrapped labels if there is only a single cluster in the cell type\n      const displayLabel = (indices.length === 1 && wrappedLabels[cellType])\n      ? wrappedLabels[cellType]\n      : cellType;\n\n      // Background rectangle for the cell type label\n      shapes.push({\n        type: 'rect',\n        xref: 'x',\n        yref: 'y',\n        x0: start - 0.5,\n        x1: end + 0.5,\n        y0: yLabels.length - 0.5 + 0.2,  // just above heatmap\n        y1: yLabels.length - 0.5 + 1.2,  // height of label\n        fillcolor: '#bfbaba',           // light gray background\n        line: {\n          color: 'white',\n          width: 2 },\n        layer: 'below'\n      });\n    \n      // Cell type label text (annotation on top)\n      annotations.push({\n        x: (start + end) / 2,\n        y: yLabels.length - 0.5 + 0.7,\n        xref: 'x',\n        yref: 'y',\n        text: displayLabel,\n        showarrow: false,\n        font: { size: 9, color: '#333' },\n        align: 'center'\n      });\n    \n      // Optional vertical separator\n      if (start > 0) {\n        shapes.push({\n          type: 'line',\n          x0: start - 0.5,\n          x1: start - 0.5,\n          y0: -0.5,\n          y1: yLabels.length - 0.5,\n          xref: 'x',\n          yref: 'y',\n          line: {\n            color: 'white',\n            width: 2\n          },\n          layer: 'above'\n        });\n      }\n    });\n\n    const allNull = zData.length === 0 || zData.flat().every(v => v === null || Number.isNaN(v));\n    \n    // Skip rendering the plot if there's no data or \"ns\" (not significant)\n    if (!xLabels.length || !yLabels.length || !zData.length || allNull) {\n      return (\n        <div id={`plot-${tpKey}`} key={tpKey} style={{ marginBottom: \"3rem\" }}>\n          <h3>{tpKey}</h3>\n          <div style={{ marginBottom: '0.5rem', color: '#666', fontStyle: 'italic' }}>\n            All values are not statistically significant or missing. No heatmap rendered.\n          </div>\n        </div>\n      );\n    }\n\n    const visible = plotVisibility[tpKey] !== false; // Default to true\n    const toggleVisibility = () => {\n      setPlotVisibility(prev => ({ ...prev, [tpKey]: !visible }));\n    };\n\n    const downloadTPData = () => {\n      const tpKey = `${tp}h`;\n      const geneListData = data[tpKey]?.[selectedGeneList];\n      if (!geneListData) return;\n    \n      const clusterMap = {}; // { CellType: [Cluster1, Cluster2, ...] }\n      const allPairs = [];\n    \n      [...selectedCellTypes].sort().forEach(cellType => {\n        const clusters = new Set();\n        selectedGenes.forEach(gene => {\n          selectedGenotypes.forEach(genotype => {\n            const clusterObj = geneListData?.[gene]?.[genotype]?.[cellType];\n            if (clusterObj) {\n              Object.keys(clusterObj).forEach(c => clusters.add(c));\n            }\n          });\n        });\n        const clusterList = Array.from(clusters).sort();\n        clusterMap[cellType] = clusterList;\n        clusterList.forEach(c => allPairs.push([cellType, c]));\n      });\n    \n      // Header rows\n      const headerRow1 = [\"Gene\", \"Genotype\", ...allPairs.map(([ct]) => ct)];\n      const headerRow2 = [\"\", \"\", ...allPairs.map(([_, cl]) => cl)];\n    \n      // Merge info for header row 1\n      const merges = [];\n      let col = 2;\n      for (const [cellType, clusters] of Object.entries(clusterMap)) {\n        const span = clusters.length;\n        if (span > 1) {\n          merges.push({\n            s: { r: 0, c: col },\n            e: { r: 0, c: col + span - 1 }\n          });\n        }\n        col += span;\n      }\n    \n      // Fill data rows\n      const dataRows = [];\n      selectedGenes.forEach(gene => {\n        selectedGenotypes.forEach(genotype => {\n          const row = [gene, genotype];\n          allPairs.forEach(([ct, cl]) => {\n            const val = geneListData?.[gene]?.[genotype]?.[ct]?.[cl];\n            row.push(val !== undefined && val !== null && !Number.isNaN(val) ? val : \"No Data\");\n          });\n          dataRows.push(row);\n        });\n      });\n    \n      // Final sheet data with headers\n      const sheetData = [headerRow1, headerRow2, ...dataRows];\n    \n      // Create workbook\n      const ws = XLSX.utils.aoa_to_sheet(sheetData);\n      ws[\"!merges\"] = merges;\n    \n      const wb = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(wb, ws, \"Sheet1\");\n    \n      XLSX.writeFile(wb, `${tpKey}_data.xlsx`);\n    };\n    \n    \n    return (\n      <div id={`plot-${tpKey}`} key={tpKey} style={{ marginBottom: \"3rem\" }}>\n        {/* Header row with title, show/hide toggle, and download button */}\n        <div\n          style={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            marginTop: '2rem',\n            flexWrap: 'wrap',\n          }}\n        >\n          {/* Left side: Timepoint label + toggle button */}\n          <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\n            <h3 style={{ margin: 0 }}>\n              {tpKey}\n              <span\n                title=\"This heatmap shows log₂ fold change. Gray tiles represent 'ns' (not statistically significant) or No data.\"\n                style={{ marginLeft: '8px', cursor: 'help', fontSize: '1rem', color: '#666' }}\n              >\n                ℹ️\n              </span>\n            </h3>\n            <button onClick={toggleVisibility} style={{ fontSize: '0.85rem' }}>\n              {visible ? 'Hide' : 'Show'}\n            </button>\n          </div>\n    \n          {/* Right side: Download button */}\n          <button\n            onClick={downloadTPData}\n            style={{\n              marginLeft: 'auto',\n              marginRight: '2rem',\n              padding: '0.4rem 0.8rem',\n              backgroundColor: '#3276db',\n              color: 'white',\n              border: 'none',\n              borderRadius: '4px',\n              fontSize: '0.9rem',\n              cursor: 'pointer',\n            }}\n          >\n            Download {tpKey} Data\n          </button>\n        </div>\n    \n        {/* Plot block */}\n        {visible && (\n          <Plot\n            useResizeHandler={false}\n            style={{ width: `${plotWidth}px`, height: `${plotHeight}px` }}\n            data={[\n              {\n                z: zData,\n                x: xLabels.map((_, i) => i),\n                y: yLabels.map((_, i) => i),\n                type: \"heatmap\",\n                colorscale: [[0, \"blue\"], [0.5, \"white\"], [1, \"red\"]],\n                zmid: 0,\n                showscale: true,\n                colorbar: {\n                  title: {\n                    text: \"log₂ Fold Change\",\n                    side: \"right\",\n                    font: { size: 12, weight: \"bold\" }\n                  }\n                },\n                hovertext: hoverData,\n                hovertemplate: \"%{y}<br>%{x}: %{hovertext}<extra></extra>\",\n              },\n              {\n                z: maskData,\n                x: xLabels.map((_, i) => i),\n                y: yLabels.map((_, i) => i),\n                type: \"heatmap\",\n                colorscale: [[0, \"rgba(0,0,0,0)\"], [1, \"#d3d3d3\"]],\n                showscale: false,\n                hoverinfo: \"skip\",\n                opacity: 1\n              }\n            ]}\n            layout={{\n              width: plotWidth,\n              height: plotHeight,\n              margin: { l: 180, r: 30, t: 40, b: 140 },\n              yaxis: {\n                tickvals: yLabels.map((_, i) => i),\n                ticktext: yLabels,\n                automargin: true,\n                dtick: 1,\n                constrain: 'domain',\n                ticks: \"\",\n              },\n              xaxis: {\n                tickvals: xLabels.map((_, i) => i),\n                ticktext: xLabels,\n                tickangle: -60,\n                tickfont: { size: 12 },\n                automargin: true,\n                constrain: 'domain',\n                ticks: '',\n                showline: false,\n                showgrid: false,\n                zeroline: false\n              },\n              shapes,\n              annotations\n            }}\n            config={{ responsive: true }}\n          />\n        )}\n      </div>\n    );\n       \n  };\n\n  return (\n    <>\n      {/* FULL-WIDTH NAVBAR */}\n      <div\n        style={{\n          position: 'sticky',\n          top: 0,\n          backgroundColor: '#f8f9fa',\n          zIndex: 100,\n          padding: '1rem 3rem 1.5rem 3rem',\n          borderBottom: '1px solid #ccc',\n          width: '100%',\n        }}\n      >\n        {/* Title positioned on top */}\n        <div style={{ width: '100%', marginBottom: '1rem' }}>\n          <h2 style={{ margin: 0 }}>Arabidopsis Gene Expression Explorer</h2>\n        </div>\n  \n        {/* Filter controls in flex container */}\n        <div\n          style={{\n            display: 'flex',\n            flexWrap: 'wrap',\n            gap: '2rem',\n            alignItems: 'flex-start',\n          }}\n        >\n          {/* GeneList */}\n          <div style={{ maxWidth: '150px', flex: '1 1 240px' }}>\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem', marginBottom: '0.5rem' }}>\n              <strong>Gene List</strong>\n              <span title=\"Select a Gene List to explore gene expression.\" style={{ marginLeft: '8px', cursor: 'help', fontSize: '1rem', color: '#666' }}>\n                ℹ️\n              </span>\n            </div>\n            <div style={{ height: 56 }}>\n              <Select\n                options={geneListOptions.map(o => ({ value: o, label: o }))}\n                value={selectedGeneList ? { value: selectedGeneList, label: selectedGeneList } : null}\n                onChange={opt => setSelectedGeneList(opt?.value || null)}\n                placeholder=\"Search Gene List...\"\n                isSearchable\n                styles={{ container: base => ({ ...base, width: '100%' }) }}\n              />\n            </div>\n          </div>\n  \n          {/* Genotypes */}\n          <div style={{ maxWidth: '220px', flex: '1 1 240px' }}>\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem', marginBottom: '0.5rem' }}>\n              <strong>Genotypes</strong>\n              <span title=\"Compare gene expression across selected genotypes.\" style={{ marginLeft: '8px', cursor: 'help', fontSize: '1rem', color: '#666' }}>\n                ℹ️\n              </span>\n            </div>\n            <Select\n              isMulti\n              options={genotypes.map(g => ({ value: g, label: g }))}\n              value={selectedGenotypes.map(g => ({ value: g, label: g }))}\n              onChange={(opts) => setSelectedGenotypes((opts || []).map(o => o.value))}\n              placeholder=\"Select genotypes\"\n              closeMenuOnSelect={false}\n              isSearchable\n              styles={{\n                container: base => ({ ...base, width: '100%' }),\n                valueContainer: base => ({\n                  ...base,\n                  maxHeight: 80,\n                  overflowY: 'auto',\n                  flexWrap: 'wrap',\n                }),\n                menu: base => ({ ...base, zIndex: 9999 }),\n              }}\n            />\n          </div>\n  \n          {/* Genes */}\n          <div style={{ maxWidth: '230px', flex: '1 1 240px' }}>\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem', marginBottom: '0.5rem' }}>\n              <strong>Genes</strong>\n              <span title=\"Choose one or more genes from the selected geneList.\" style={{ marginLeft: '8px', cursor: 'help', fontSize: '1rem', color: '#666' }}>\n                ℹ️\n              </span>\n            </div>\n            <div style={{ height: 120, display: 'flex', alignItems: 'stretch' }}>\n              <Select\n                isMulti\n                options={geneOptions.map(g => ({ value: g, label: g }))}\n                value={selectedGenes.map(g => ({ value: g, label: g }))}\n                onChange={opts => setSelectedGenes(opts.map(o => o.value))}\n                placeholder=\"Select genes\"\n                isSearchable\n                isDisabled={!selectedGeneList}\n                styles={{\n                  container: base => ({ ...base, width: '100%' }),\n                  control: base => ({\n                    ...base,\n                    minHeight: 120,\n                    height: 120,\n                    alignItems: 'flex-start',\n                  }),\n                  valueContainer: base => ({\n                    ...base,\n                    maxHeight: 80,\n                    overflowY: 'auto',\n                    flexWrap: 'wrap',\n                  }),\n                  menu: base => ({ ...base, zIndex: 9999 }),\n                }}\n              />\n            </div>\n          </div>\n  \n          {/* Cell Types */}\n          <div style={{ maxWidth: '240px', flex: '1 1 240px' }}>\n            <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem', marginBottom: '0.5rem' }}>\n              <strong>Cell Types</strong>\n              <span title=\"Filter by specific cell types to focus your analysis.\" style={{ marginLeft: '8px', cursor: 'help', fontSize: '1rem', color: '#666' }}>\n                ℹ️\n              </span>\n            </div>\n            <div style={{ height: 120, display: 'flex', alignItems: 'stretch' }}>\n              <Select\n                isMulti\n                options={cellTypes.map(ct => ({ value: ct, label: ct }))}\n                value={selectedCellTypes.map(ct => ({ value: ct, label: ct }))}\n                onChange={(opts) => setSelectedCellTypes((opts || []).map(o => o.value))}\n                placeholder=\"Select cell types\"\n                closeMenuOnSelect={false}\n                isSearchable\n                styles={{\n                  container: base => ({ ...base, width: '100%' }),\n                  control: base => ({\n                    ...base,\n                    minHeight: 120,\n                    height: 120,\n                    alignItems: 'flex-start',\n                  }),\n                  valueContainer: base => ({\n                    ...base,\n                    maxHeight: 80,\n                    overflowY: 'auto',\n                    flexWrap: 'wrap',\n                  }),\n                  menu: base => ({ ...base, zIndex: 9999 }),\n                }}\n              />\n            </div>\n          </div>\n  \n          {/* Timepoint */}\n          {timepoints.length > 1 && (\n            <div style={{ maxWidth: '280px', flex: '1 1 240px' }}>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem', marginBottom: '0.5rem' }}>\n                <strong>Timepoint</strong>\n                <span title=\"Select a range of timepoints to display plots.\" style={{ marginLeft: '8px', cursor: 'help', fontSize: '1rem', color: '#666' }}>\n                  ℹ️\n                </span>\n              </div>\n              <Slider\n                range\n                min={timepoints[0]}\n                max={timepoints[timepoints.length - 1]}\n                value={selectedTimepointRange}\n                onChange={range => setSelectedTimepointRange(range)}\n                marks={timepoints.reduce((acc, tp) => {\n                  acc[tp] = tp.toString();\n                  return acc;\n                }, {})}\n                step={null}\n                allowCross={false}\n                style={{ width: '100%' }}\n              />\n            </div>\n          )}\n        </div>\n      </div>\n  \n      {/* CONTENT AREA */}\n      <div style={{ padding: '1rem', paddingLeft: '5vw' }}>\n        {timepoints\n          .filter(tp => tp >= selectedTimepointRange[0] && tp <= selectedTimepointRange[1])\n          .map(tp => renderPlot(tp))}\n  \n        {showScrollUp && (\n          <button\n            onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}\n            style={{\n              position: 'fixed',\n              bottom: '30px',\n              right: '30px',\n              zIndex: 1000,\n              padding: '0.6rem 0.95rem',\n              fontSize: '1.5rem',\n              borderRadius: '50%',\n              backgroundColor: '#007bff',\n              color: 'white',\n              border: 'none',\n              boxShadow: '0 2px 6px rgba(0,0,0,0.2)',\n              cursor: 'pointer'\n            }}\n          >\n            ⮝\n          </button>\n        )}\n      </div>\n    </>\n  );\n  \n  \n}\n\nexport default function WrappedApp() {\n  return (\n    <BrowserRouter>\n      <App />\n    </BrowserRouter>\n  );\n}\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}